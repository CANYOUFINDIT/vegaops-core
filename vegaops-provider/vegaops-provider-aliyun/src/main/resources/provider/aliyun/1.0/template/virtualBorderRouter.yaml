vendor: aliyun
nodeType: virtualBorderRouter
componentId: '#componentId'
actions:
- install-uninstall
- list
- query
- modify
profile: T(com.aliyuncs.profile.DefaultProfile).getProfile(#regionId,#accessKey,#secret)
install:
  output:
    regionId: '#regionId'
    success: '#throwable eq null'
    after:
      retryTimes: '10'
      output:
        success: '#throwable eq null'
        mergeKeys: '*'
      input:
        vbrId: '#vbrId'
      action: query
      waitInterval: '3000'
    vbrId: '#result.VbrId'
  request:
    physicalConnectionId: '#physicalConnectionId'
    peerIpv6GatewayIp: '#peerIpv6GatewayIp'
    peerGatewayIp: '#peerGatewayIp'
    vlanId: '#vlanId'
    vbrOwnerId: '#vbrOwnerId'
    peeringSubnetMask: '#peeringSubnetMask'
    description: '#description'
    localGatewayIp: '#localGatewayIp'
    circuitCode: '#circuitCode'
    name: '#name'
    localIpv6GatewayIp: '#localIpv6GatewayIp'
    enableIpv6: '#enableIpv6'
    class: com.aliyuncs.vpc.model.v20160428.CreateVirtualBorderRouterRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
uninstall:
  output:
    deleteProviderId: '#vbrId'
    success: '#throwable eq null'
  request:
    vbrId: '#vbrId'
    class: com.aliyuncs.vpc.model.v20160428.DeleteVirtualBorderRouterRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
list:
  output:
    log: 'false'
    success: '#throwable eq null'
    loop:
      '1': '#request.setPageNumber(#request.getPageNumber()+1)'
      condition: '#result.getVirtualBorderRouterSet().size() != 0'
      appendList:
      - vbrList
    '[vbrList]:[#result.VirtualBorderRouterSet]':
      physicalConnectionId: '#PhysicalConnectionId'
      peerGatewayIp: '#PeerGatewayIp'
      creationTime: '#CreationTime'
      vlanId: '#VlanId'
      physicalConnectionStatus: '#PhysicalConnectionStatus'
      physicalConnectionBusinessStatus: '#PhysicalConnectionBusinessStatus'
      accessPointId: '#AccessPointId'
      peeringSubnetMask: '#PeeringSubnetMask'
      localGatewayIp: '#LocalGatewayIp'
      vbrId: '#VbrId'
      vlanInterfaceId: '#VlanInterfaceId'
      providerId: '#VbrId'
      routeTableId: '#RouteTableId'
      physicalConnectionOwnerUid: '#PhysicalConnectionOwnerUid'
      activationTime: '#ActivationTime'
      ipv6CidrBlock: '#Ipv6CidrBlock'
      status: '#Status'
  request:
    pageNumber: '1'
    pageSize: '10'
    class: com.aliyuncs.vpc.model.v20160428.DescribeVirtualBorderRoutersRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
query:
  argTypes:
  - org.prophetech.hyperone.vegaops.alicloud.model.DescribeVbrRequest
  output:
    physicalConnectionId: '#result ?.PhysicalConnectionId'
    peerGatewayIp: '#result ?.PeerGatewayIp'
    creationTime: '#result ?.CreationTime'
    vlanId: '#result ?.VlanId'
    physicalConnectionStatus: '#result ?.PhysicalConnectionStatus'
    physicalConnectionBusinessStatus: '#result ?.PhysicalConnectionBusinessStatus'
    accessPointId: '#result ?.AccessPointId'
    peeringSubnetMask: '#result ?.PeeringSubnetMask'
    localGatewayIp: '#result ?.LocalGatewayIp'
    vbrId: '#result ?.VbrId'
    success: '#throwable eq null'
    vlanInterfaceId: '#result ?.VlanInterfaceId'
    providerId: '#result ?.VbrId'
    routeTableId: '#result ?.RouteTableId'
    physicalConnectionOwnerUid: '#result ?.PhysicalConnectionOwnerUid'
    activationTime: '#result ?.ActivationTime'
    ipv6CidrBlock: '#result ?.Ipv6CidrBlock'
    status: '#result ?.Status'
  method: getVbr
  param:
    regionId: '#regionId'
    accessKey: '#accessKey'
    secret: '#secret'
    vbrId: '#vbrId'
  argNames:
  - param
  argValues:
    param: '#param'
  client: org.prophetech.hyperone.vegaops.alicloud.client.AliyunVbrClient
modify:
  output:
    success: '#throwable eq null'
    after:
      retryTimes: '10'
      output:
        success: '#throwable eq null'
        mergeKeys: '*'
      input:
        vpcId: '#vpcId'
      action: query
      waitInterval: '3000'
  request:
    peerIpv6GatewayIp: '#peerIpv6GatewayIp'
    associatedPhysicalConnections: '#associatedPhysicalConnections'
    peerGatewayIp: '#peerGatewayIp'
    minRxInterval: '#minRxInterval'
    vlanId: '#vlanId'
    peeringSubnetMask: '#peeringSubnetMask'
    minTxInterval: '#minTxInterval'
    description: '#description'
    localGatewayIp: '#localGatewayIp'
    vbrId: '#vbrId'
    detectMultiplier: '#detectMultiplier'
    peeringIpv6SubnetMask: '#peeringIpv6SubnetMask'
    circuitCode: '#circuitCode'
    name: '#name'
    localIpv6GatewayIp: '#localIpv6GatewayIp'
    enableIpv6: '#enableIpv6'
    class: com.aliyuncs.vpc.model.v20160428.ModifyVirtualBorderRouterAttributeRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
