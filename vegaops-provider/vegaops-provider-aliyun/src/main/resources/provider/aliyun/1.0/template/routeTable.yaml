vendor: aliyun
nodeType: routeTable
componentId: '#componentId'
actions:
- list
- install-uninstall
- query
profile: T(com.aliyuncs.profile.DefaultProfile).getProfile(#regionId,#accessKey,#secret)
list:
  output:
    log: 'false'
    success: '#throwable eq null'
    loop:
      '1': '#request.setPageNumber(#request.getPageNumber()+1)'
      condition: '#result.getRouteTables().size() != 0'
      appendList:
      - routeTableList
    '[routeTableList]:[#result.RouteTables]':
      regionId: '#regionId'
      providerId: '#RouteTableId'
      type: '#RouteTableType'
  request:
    pageNumber: '1'
    pageSize: '10'
    class: com.aliyuncs.vpc.model.v20160428.DescribeRouteTablesRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
query:
  output:
    vRouterId: '#result.getRouteTables().size() eq 0 ? null: #result.getRouteTables().get(0).getVRouterId()'
    creationTime: '#result.getRouteTables().size() eq 0 ? null: #result.getRouteTables().get(0).getCreationTime()'
    routeTableType: '#result.getRouteTables().size() eq 0 ? null: #result.getRouteTables().get(0).getRouteTableType()'
    success: '#throwable eq null'
    providerId: '#result.getRouteTables().size() eq 0 ? null: #result.getRouteTables().get(0).getRouteTableId()'
  request:
    routeTableId: '#routeTableId'
    class: com.aliyuncs.vpc.model.v20160428.DescribeRouteTablesRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
install:
  output:
    success: '#throwable eq null'
    routeTableId: result.routeTableId
    after:
      retryTimes: '10'
      output:
        success: '#throwable eq null'
        mergeKeys: '*'
      input:
        routeTableId: '#routeTableId'
      action: query
      waitInterval: '3000'
  request:
    vpcId: '#vpcId'
    routeTableName: '#name'
    description: '#description'
    class: com.aliyuncs.vpc.model.v20160428.CreateRouteTableRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
uninstall:
  output:
    deleteProviderId: '#routeTableId'
    success: '#throwable eq null'
  request:
    routeTableId: '#routeTableId'
    class: com.aliyuncs.vpc.model.v20160428.DeleteRouteTableRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
