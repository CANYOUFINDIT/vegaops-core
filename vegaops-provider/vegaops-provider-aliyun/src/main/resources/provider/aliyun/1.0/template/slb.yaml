vendor: aliyun
nodeType: slb
componentId: '#componentId'
actions:
- install-uninstall
- list
- query
profile: T(com.aliyuncs.profile.DefaultProfile).getProfile(#regionId,#accessKey,#secret)
install:
  output:
    loadBalancerId: '#result.LoadBalancerId'
    success: '#throwable eq null'
    after:
      retryTimes: '10'
      output:
        success: '#throwable eq null'
        mergeKeys: '*'
      input:
        loadBalancerId: '#loadBalancerId'
      action: query
      waitInterval: '3000'
  request:
    autoPay: '#autoPay'
    loadBalancerSpec: '#loadBalancerSpec'
    address: '#address'
    bandwidth: '#bandwidth'
    masterZoneId: '#masterZoneId'
    addressType: '#addressType'
    VSwitchId: '#vswitchId'
    addressIPVersion: '#addressIPVersion'
    deleteProtection: '#deleteProtection'
    duration: '#duration'
    internetChargeType: '#internetChargeType'
    payType: '#payType'
    slaveZoneId: '#slaveZoneId'
    loadBalancerName: '#name'
    vpcId: '#vpcId'
    pricingCycle: '#pricingCycle'
    class: com.aliyuncs.slb.model.v20140515.CreateLoadBalancerRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
uninstall:
  output:
    deleteProviderId: '#loadBalancerId'
    success: '#throwable eq null'
  request:
    loadBalancerId: '#loadBalancerId'
    class: com.aliyuncs.slb.model.v20140515.DeleteLoadBalancerRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
list:
  output:
    log: 'false'
    success: '#throwable eq null'
    loop:
      '1': '#request.setPageNumber(#request.getPageNumber()+1)'
      condition: '#result.getLoadBalancers().size() != 0'
      appendList:
      - slbList
    '[slbList]:[#result.LoadBalancers]':
      loadBalancerId: '#LoadBalancerId'
      address: '#Address'
      masterZoneId: '#MasterZoneId'
      addressType: '#AddressType'
      addressIPVersion: '#AddressIPVersion'
      vswitchId: '#VSwitchId'
      internetChargeType: '#InternetChargeType'
      payType: '#PayType'
      slaveZoneId: '#SlaveZoneId'
      regionId: '#RegionId'
      createTime: '#CreateTime'
      providerId: '#LoadBalancerId'
      vpcId: '#VpcId'
      name: '#LoadBalancerName'
      networkType: '#NetworkType'
      status: '#LoadBalancerStatus'
  request:
    pageNumber: '1'
    pageSize: '100'
    class: com.aliyuncs.slb.model.v20140515.DescribeLoadBalancersRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
query:
  output:
    loadBalancerId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getLoadBalancerId()'
    address: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getAddress()'
    masterZoneId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getMasterZoneId()'
    addressType: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getAddressType()'
    addressIPVersion: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getAddressIPVersion()'
    vswitchId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getVSwitchId()'
    internetChargeType: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getInternetChargeType()'
    payType: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getPayType()'
    slaveZoneId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getSlaveZoneId()'
    regionId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getRegionId()'
    createTime: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getCreateTime()'
    success: '#throwable eq null'
    providerId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getLoadBalancerId()'
    vpcId: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getVpcId()'
    name: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getLoadBalancerName()'
    networkType: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getNetworkType()'
    status: '#result.getLoadBalancers().size() eq 0 ? null: #result.getLoadBalancers().get(0).getLoadBalancerStatus()'
  request:
    loadBalancerId: '#loadBalancerId'
    class: com.aliyuncs.slb.model.v20140515.DescribeLoadBalancersRequest
  method: getAcsResponse
  argValues:
    request: '#request'
  client: new com.aliyuncs.DefaultAcsClient(#profile)
